<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insurance Data Form</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- Module Loader - Loads modular JavaScript files -->
    <script src="js/loader.js"></script>
    <!-- Application Initialization - Must load after modules -->
    <script src="js/init.js"></script>
</head>

<body class="bg-gray-100 p-4 sm:p-6 md:p-8">


    <!-- Theme Toggle Button -->
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark/light mode">
        <span class="sun-icon">‚òÄÔ∏è</span>
        <span class="moon-icon">üåô</span>
    </button>

    <div class="max-w-7xl mx-auto">
        <!-- Form View -->
        <div id="form-view">
            <div class="max-w-4xl mx-auto">
                <!-- Header container with relative positioning -->
                <div class="relative flex justify-center items-center mb-8">
                    <div class="absolute left-0"><img src="assets/lic_logo.png" alt="Company Logo"
                            class="h-16 w-auto object-contain"></div>
                    <h1 class="text-3xl font-bold"
                        style="background: linear-gradient(135deg, var(--primary-start), var(--primary-end), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        Data Sheet</h1>
                    <div class="absolute right-0 text-right">
                        <h2 class="text-xl font-bold text-gray-800">Rapolu Venkateshwarlu</h2>
                        <p class="text-sm text-gray-600">Insurance Advisor</p>
                    </div>
                </div>

                <!-- Main Tab Navigation -->
                <div class="flex justify-center space-x-4 mb-8">
                    <button id="form-tab-button" class="main-tab-button active" onclick="showMainTab('form-view')">Data
                        Entry Form</button>
                    <button id="view-tab-button" class="main-tab-button" onclick="showMainTab('data-view')">View
                        Submitted Data</button>
                </div>

                <!-- Stepper/Wizard Navigation -->
                <div id="form-tabs-nav" class="stepper-container">
                    <!-- Stepper steps will be generated here by JS -->
                </div>
                <form id="data-form">
                    <!-- Applicant Details -->
                    <div class="form-section form-tab-panel" data-tab-name="Applicant">
                        <h2>Applicant Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="name_of_la">Name of Life Assured <span
                                        class="required-asterisk">*</span></label><input type="text" id="name_of_la"
                                    name="name_of_la" class="mt-1" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="proposer">Proposer Name</label><input type="text" id="proposer"
                                    name="proposer" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="aadhaar">Aadhaar <span class="required-asterisk">*</span></label><input
                                    type="text" id="aadhaar" name="aadhaar" class="mt-1" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ckyc">CKYC</label><input type="text" id="ckyc" name="ckyc"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="abha">ABHA</label><input type="text" id="abha" name="abha"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="pan">PAN</label><input type="text" id="pan" name="pan" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="f_name">Father's Name</label><input type="text" id="f_name" name="f_name"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="m_name">Mother's Name</label><input type="text" id="m_name" name="m_name"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div>
                                <label for="gender">Gender <span class="required-asterisk">*</span></label>
                                <select id="gender" name="gender" class="mt-1 dropdown-padding" required>
                                    <option value="">Select</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Trans">Trans</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div>
                                <label for="is_married">Is Married <span class="required-asterisk">*</span></label>
                                <select id="is_married" name="is_married" class="mt-1 dropdown-padding"
                                    aria-label="Is Married" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div class="marriage-dependent hidden"><label for="spouse">Spouse's Name <span
                                        class="required-asterisk">*</span></label><input type="text" id="spouse"
                                    name="spouse" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div class="marriage-dependent hidden"><label for="d_marriage">Date of
                                    Marriage</label><input type="date" id="d_marriage" name="d_marriage"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>

                        </div>
                        <div class="flex justify-end mt-6"><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Contact Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Contact">
                        <h2>Contact & Personal Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="mobile_adhar">Mobile (Aadhaar) <span
                                        class="required-asterisk">*</span></label><input type="tel" id="mobile_adhar"
                                    name="mobile_adhar" class="mt-1" pattern="\d{10}"
                                    title="Please enter a 10-digit mobile number" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="mobile">Mobile </label><input type="tel" id="mobile" name="mobile"
                                    class="mt-1" pattern="\d{10}" title="Please enter a 10-digit mobile number"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="email">E-mail </label><input type="email" id="email" name="email"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="whatsapp">Whatsapp</label><input type="tel" id="whatsapp" name="whatsapp"
                                    class="mt-1" pattern="\d{10}"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="dob">DOB <span class="required-asterisk">*</span></label><input type="date"
                                    id="dob" name="dob" class="mt-1" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="birth_place">Birth Place</label><input type="text" id="birth_place"
                                    name="birth_place" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="near_lb_age">Age</label><input type="text" id="near_lb_age"
                                    name="near_lb_age" class="mt-1" readonly placeholder="Calculated from DOB"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div>
                                <label for="residential_status">Residential Status</label>
                                <select id="residential_status" name="residential_status" class="mt-1 dropdown-padding"
                                    style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="Resident Indian">Resident Indian</option>
                                    <option value="NRI">NRI</option>
                                    <option value="FNIO">FNIO</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <!-- Checkbox first, then address fields side by side -->
                            <div class="md:col-span-2 flex items-center space-x-3 mt-2">
                                <input type="checkbox" id="corr_same_kyc" name="corr_same_kyc" class="mt-1">
                                <label for="corr_same_kyc" class="mb-0">Is the correspondence address same as
                                    KYC?</label>
                            </div>
                            <div class="md:col-span-1"><label for="address">Address as per KYC</label><textarea
                                    id="address" name="address" class="mt-1 w-full" rows="3"
                                    style="resize: vertical; min-height: 80px;"></textarea><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div class="md:col-span-1" id="corr-address-container"><label
                                    for="corr_address">Correspondence Address</label><textarea id="corr_address"
                                    name="corr_address" class="mt-1 w-full" rows="3"
                                    style="resize: vertical; min-height: 80px;"></textarea><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Education & Qualification -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Education & Qualification">
                        <h2>Education & Qualification Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div><label for="education">Education</label><input type="text" id="education"
                                    name="education" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="current_job">Current Job</label><input type="text" id="current_job"
                                    name="current_job" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="type_of_duty">Type of Duty</label><input type="text" id="type_of_duty"
                                    name="type_of_duty" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="co_name">Company Name</label><input type="text" id="co_name" name="co_name"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="since">Since</label><input type="text" id="since" name="since"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="total_experience">Total Experience</label><input type="text"
                                    id="total_experience" name="total_experience" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="a_income">‚Çπ Annual Income</label><input type="text" inputmode="numeric"
                                    id="a_income" name="a_income" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ly_income1">‚Çπ LY Income 1</label><input type="text" inputmode="numeric"
                                    id="ly_income1" name="ly_income1" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ly_income2">‚Çπ LY Income 2</label><input type="text" inputmode="numeric"
                                    id="ly_income2" name="ly_income2" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ly_income3">‚Çπ LY Income 3</label><input type="text" inputmode="numeric"
                                    id="ly_income3" name="ly_income3" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <!-- Husband details: shown when Gender is Female -->
                            <div id="husband-details-section"
                                class="hidden md:col-span-2 lg:col-span-3 form-section bg-gray-50 p-4 rounded">
                                <h3 class="font-semibold mb-3">Husband Details</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div><label for="husband_occupation">Occupation</label><input type="text"
                                            id="husband_occupation" name="husband_occupation" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div><label for="husband_annual_income">‚Çπ Annual Income</label><input type="text"
                                            inputmode="numeric" id="husband_annual_income" name="husband_annual_income"
                                            class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Plan Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Proposed Plan">
                        <h2>Proposed Plan</h2>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                            <div><label for="plan_term">PLAN / Term <span
                                        class="required-asterisk">*</span></label><input type="text" id="plan_term"
                                    name="plan_term" class="mt-1" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ppt">PPT</label><input type="text" id="ppt" name="ppt" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div>
                                <label for="mode">Mode</label>
                                <select id="mode" name="mode" class="mt-1 dropdown-padding" style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="Yearly">Yearly</option>
                                    <option value="Half Yearly">Half Yearly</option>
                                    <option value="Quarterly">Quarterly</option>
                                    <option value="NACH">NACH</option>
                                    <option value="Single">Single</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div><label for="sum_assured">Sum Assured</label><input type="number" id="sum_assured"
                                    min="0" name="sum_assured" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div>
                                <label for="ab_addb">Accidental Benefit</label>
                                <select id="ab_addb" name="ab_addb" class="mt-1 dropdown-padding" style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="AB">AB</option>
                                    <option value="ADDB">ADDB</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div>
                                <label for="term_rider">Term Rider</label>
                                <select id="term_rider" name="term_rider" class="mt-1 dropdown-padding"
                                    style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div><label for="premium">Premium <span class="required-asterisk">*</span></label><input
                                    type="number" id="premium" min="0" name="premium" class="mt-1" required><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div>
                                <label for="dating_back">Dating Back</label>
                                <select id="dating_back" name="dating_back" class="mt-1 dropdown-padding"
                                    style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div id="dating-back-date-container" class="hidden">
                                <label for="dating_back_date">Dating Back Date</label>
                                <input type="date" id="dating_back_date" name="dating_back_date" class="mt-1">
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div>
                                <label for="pwb">PWB</label>
                                <select id="pwb" name="pwb" class="mt-1 dropdown-padding" style="height: 3rem;">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <span class="error-message text-red-500 text-sm mt-1"></span>
                            </div>
                            <div><label for="boc_number">BOC Number</label><input type="text" id="boc_number"
                                    name="boc_number" class="mt-1" placeholder="Enter BOC number"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="boc_date">BOC Date</label><input type="date" id="boc_date" name="boc_date"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="boc_amt">BOC Amt</label><input type="number" id="boc_amt" min="0"
                                    name="boc_amt" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="doc">DOC</label><input type="date" id="doc" name="doc" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="policy_no">Policy No</label><input type="text" id="policy_no"
                                    name="policy_no" class="mt-1" placeholder="Enter Policy number"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Nominee Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Nominee">
                        <h2>Nominee & Appointee Details</h2>
                        <div class="mb-4 form-section bg-gray-50 p-4 rounded">
                            <h3 class="font-semibold mb-3">Nominees</h3>
                            <div id="nominees-repeater" class="space-y-3">
                                <!-- nominee items injected here -->
                            </div>
                            <template id="nominee-template">
                                <div
                                    class="nominee-item relative grid grid-cols-1 md:grid-cols-6 gap-3 p-3 rounded border border-gray-200 bg-white items-end">
                                    <button type="button"
                                        class="remove-nominee absolute top-2 right-2 text-gray-500 hover:text-gray-800 bg-transparent p-1 rounded"
                                        aria-label="Remove nominee">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                    <div class="md:col-span-2"><label class="text-xs text-gray-600">Name</label><input
                                            type="text" name="nominee_name" class="mt-1 nominee-name"></div>
                                    <div><label class="text-xs text-gray-600">Share %</label><input type="number"
                                            min="0" max="100" step="0.01" name="nominee_share"
                                            class="mt-1 nominee-share"></div>
                                    <div><label class="text-xs text-gray-600">Date of Birth</label><input type="date"
                                            name="nominee_dob" class="mt-1 nominee-dob"></div>
                                    <div><label class="text-xs text-gray-600">Relation</label><input type="text"
                                            name="nominee_relation" class="mt-1 nominee-relation"></div>
                                    <div><label class="text-xs text-gray-600">Aadhaar</label><input type="text"
                                            name="nominee_aadhaar" class="mt-1 nominee-aadhaar"></div>
                                </div>
                            </template>
                            <div class="mt-3">
                                <button type="button" id="add-nominee"
                                    class="bg-blue-600 text-white font-bold py-2 px-4 rounded">Add Nominee</button>
                            </div>
                            <div id="nominee-error" class="text-sm text-red-600 mt-2"></div>
                        </div>
                        <hr class="my-6 border-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div><label for="appointee">Appointee</label><input type="text" id="appointee"
                                    name="appointee" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="appointee_relation">Relation</label><input type="text"
                                    id="appointee_relation" name="appointee_relation" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="appointee_age">Age</label><input type="number" id="appointee_age"
                                    name="appointee_age" min="0" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Bank Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Bank">
                        <h2>Bank Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="bank_name">Bank Name</label><input type="text" id="bank_name"
                                    name="bank_name" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ac_type">A/c Type</label><input type="text" id="ac_type" name="ac_type"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div class="md:col-span-2"><label for="ac_holder_name">A/c Holder's Name</label><input
                                    type="text" id="ac_holder_name" name="ac_holder_name" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div class="md:col-span-2"><label for="bank_address">Address</label><input type="text"
                                    id="bank_address" name="bank_address" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ac_no">A/C No.</label><input type="text" id="ac_no" name="ac_no"
                                    class="mt-1"><span class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="micr_code">MICR Code</label><input type="text" id="micr_code"
                                    name="micr_code" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                            <div><label for="ifsc_code">IFSC Code</label><input type="text" id="ifsc_code"
                                    name="ifsc_code" class="mt-1"><span
                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>
                    </div>

                    <!-- Medical Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Medical History">
                        <h2>Family & Medical Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div>
                                <h3 class="font-semibold text-lg mb-2">Father's Details</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div><label for="fam_father_age">Age</label><input type="number" id="fam_father_age"
                                            min="0" name="fam_father_age" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div>
                                        <label for="fam_father_state">State of Health</label>
                                        <select id="fam_father_state" name="fam_father_state"
                                            class="mt-1 dropdown-padding" style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Good">Good</option>
                                            <option value="Dead">Dead</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="father-death-container" class="md:col-span-2 hidden">
                                        <div class="grid grid-cols-3 gap-4">
                                            <div><label for="fam_father_died_age">Age at Death</label><input
                                                    type="number" min="0" id="fam_father_died_age"
                                                    name="fam_father_died_age" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_father_died_year">Death Year</label><input
                                                    type="number" min="0" id="fam_father_died_year"
                                                    name="fam_father_died_year" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_father_died_cause">Cause of Death</label><input
                                                    type="text" id="fam_father_died_cause" name="fam_father_died_cause"
                                                    class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg mb-2">Mother's Details</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div><label for="fam_mother_age">Age</label><input type="number" id="fam_mother_age"
                                            min="0" name="fam_mother_age" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div>
                                        <label for="fam_mother_state">State of Health</label>
                                        <select id="fam_mother_state" name="fam_mother_state"
                                            class="mt-1 dropdown-padding" style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Good">Good</option>
                                            <option value="Dead">Dead</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="mother-death-container" class="md:col-span-2 hidden">
                                        <div class="grid grid-cols-3 gap-4">
                                            <div><label for="fam_mother_died_age">Age at Death</label><input
                                                    type="number" min="0" id="fam_mother_died_age"
                                                    name="fam_mother_died_age" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_mother_died_year">Death Year</label><input
                                                    type="number" min="0" id="fam_mother_died_year"
                                                    name="fam_mother_died_year" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_mother_died_cause">Cause of Death</label><input
                                                    type="text" id="fam_mother_died_cause" name="fam_mother_died_cause"
                                                    class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="font-semibold text-lg mb-2">Spouse Details</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div><label for="fam_spouse_age">Age</label><input type="number" id="fam_spouse_age"
                                            min="0" name="fam_spouse_age" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div>
                                        <label for="fam_spouse_state">State of Health</label>
                                        <select id="fam_spouse_state" name="fam_spouse_state"
                                            class="mt-1 dropdown-padding" style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Good">Good</option>
                                            <option value="Dead">Dead</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="spouse-death-container" class="md:col-span-2 hidden">
                                        <div class="grid grid-cols-3 gap-4">
                                            <div><label for="fam_spouse_died_age">Age at Death</label><input
                                                    type="number" min="0" id="fam_spouse_died_age"
                                                    name="fam_spouse_died_age" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_spouse_died_year">Death Year</label><input
                                                    type="number" min="0" id="fam_spouse_died_year"
                                                    name="fam_spouse_died_year" class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                            <div><label for="fam_spouse_died_cause">Cause of Death</label><input
                                                    type="text" id="fam_spouse_died_cause" name="fam_spouse_died_cause"
                                                    class="mt-1"><span
                                                    class="error-message text-red-500 text-sm mt-1"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="md:col-span-2 mt-4">
                                <h3 class="font-semibold text-lg mb-2">Siblings & Children</h3>
                                <div class="grid grid-cols-3 gap-4">
                                    <div>
                                        <label for="num_brothers">Number of Brothers</label>
                                        <input type="number" id="num_brothers" name="num_brothers" min="0" class="mt-1"
                                            value="0">
                                    </div>
                                    <div>
                                        <label for="num_sisters">Number of Sisters</label>
                                        <input type="number" id="num_sisters" name="num_sisters" min="0" class="mt-1"
                                            value="0">
                                    </div>
                                    <div>
                                        <label for="num_children">Number of Children</label>
                                        <input type="number" id="num_children" name="num_children" min="0" class="mt-1"
                                            value="0">
                                    </div>
                                </div>

                                <div id="brothers-repeater" class="mt-4 space-y-3"></div>
                                <div id="sisters-repeater" class="mt-4 space-y-3"></div>
                                <div id="children-repeater" class="mt-4 space-y-3"></div>
                            </div>
                            <div class="md:col-span-2 mt-4">
                                <h3 class="font-semibold text-lg mb-2">Medical Details</h3>
                                <div class="grid grid-cols-3 gap-4">
                                    <div><label for="height">Height (Cm)</label><input type="number" id="height" min="0"
                                            name="height" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div><label for="weight">Weight (Kg)</label><input type="number" id="weight" min="0"
                                            name="weight" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div><label for="abd">Abd (Cm)</label><input type="number" id="abd" min="0"
                                            name="abd" class="mt-1"><span
                                            class="error-message text-red-500 text-sm mt-1"></span></div>
                                    <div>
                                        <label for="any_operations">Any Operations?</label>
                                        <select id="any_operations" name="any_operations" class="mt-1 dropdown-padding"
                                            style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="operation-details-container" class="hidden md:col-span-2">
                                        <label for="operation_details">Operation details</label>
                                        <input type="text" id="operation_details" name="operation_details" class="mt-1">
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div>
                                        <label for="any_diseases">Any Diseases?</label>
                                        <select id="any_diseases" name="any_diseases" class="mt-1 dropdown-padding"
                                            style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="disease-details-container" class="hidden md:col-span-2">
                                        <label for="disease_details">Disease details</label>
                                        <input type="text" id="disease_details" name="disease_details" class="mt-1">
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <!-- Pregnancy fields: shown only when Gender === 'Female' -->
                                    <div id="pregnancy-section" class="hidden md:col-span-1">
                                        <label for="are_pregnant">Are you pregnant?</label>
                                        <select id="are_pregnant" name="are_pregnant" class="mt-1 dropdown-padding"
                                            style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                    <div id="last-delivery-container" class="hidden md:col-span-1">
                                        <label for="last_delivery_date">Date of last delivery</label>
                                        <input type="date" id="last_delivery_date" name="last_delivery_date"
                                            class="mt-1">
                                        <span class="error-message text-red-500 text-sm mt-1"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button><button type="button" onclick="navigateFormTab(1)"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next
                                &rarr;</button></div>

                    </div>

                    <!-- Previous Policy Details -->
                    <div class="form-section form-tab-panel hidden" data-tab-name="Previous Policy">
                        <h2>Previous Policy Details</h2>
                        <div class="text-sm text-gray-600 mb-4">Click the "Add Previous Policy" button below to add
                            one
                            or more previous policies.</div>
                        <!-- Multi previous policies repeater (keeps the legacy single fields above) -->
                        <div class="mt-6 form-section bg-gray-50 p-4 rounded">
                            <div id="previous-policies-repeater" class="space-y-3">
                                <!-- items injected here -->
                            </div>
                            <template id="previous-policy-template">
                                <div
                                    class="previous-policy-item relative grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 p-3 rounded border border-gray-200 bg-white">
                                    <div><label class="text-xs text-gray-600">Policy Number</label><input type="text"
                                            class="mt-1 prev-field prev-policy-no"></div>
                                    <div><label class="text-xs text-gray-600">Branch</label><input type="text"
                                            class="mt-1 prev-field prev-branch"></div>
                                    <div><label class="text-xs text-gray-600">Plan/Term</label><input type="text"
                                            class="mt-1 prev-field prev-plan-term"></div>
                                    <div><label class="text-xs text-gray-600">Sum Assured</label><input type="text"
                                            class="mt-1 prev-field prev-sa"></div>
                                    <div><label class="text-xs text-gray-600">Premium</label><input type="text"
                                            class="mt-1 prev-field prev-y-premium"></div>
                                    <div><label class="text-xs text-gray-600">Mode</label>
                                        <select class="mt-1 prev-field prev-mode dropdown-padding" name="prev_mode"
                                            style="height: 3.2rem;">
                                            <option value="">Select</option>
                                            <option value="Yearly">Yearly</option>
                                            <option value="Half Yearly">Half Yearly</option>
                                            <option value="Quarterly">Quarterly</option>
                                            <option value="NACH">NACH</option>
                                            <option value="Single">Single</option>
                                        </select>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Accidental Benefit</label>
                                        <select class="mt-1 prev-field prev-ab-addb dropdown-padding"
                                            name="prev_ab_addb" style="height: 3.2rem;">
                                            <option value="">Select</option>
                                            <option value="AB">AB</option>
                                            <option value="ADDB">ADDB</option>
                                        </select>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Date of Commencement</label><input
                                            type="date" class="mt-1 prev-field prev-doc"></div>
                                    <div><label class="text-xs text-gray-600">Rate Accepted</label>
                                        <select class="mt-1 prev-field prev-or dropdown-padding" name="prev_or"
                                            style="height: 3.2rem;">
                                            <option value="">Select</option>
                                            <option value="Ordinary Rate">Ordinary Rate</option>
                                            <option value="Special Rate">Special Rate</option>
                                        </select>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Medical</label>
                                        <select class="mt-1 prev-field prev-m-nm dropdown-padding" name="prev_m_nm"
                                            style="height: 3.2rem;">
                                            <option value="">Select</option>
                                            <option value="Medical">Medical</option>
                                            <option value="Non-Medical">Non-Medical</option>
                                        </select>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Inforce</label>
                                        <select class="mt-1 prev-field prev-inforce dropdown-padding"
                                            name="prev_inforce" style="height: 3.2rem;">
                                            <option value="">Select</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                    </div>
                                    <button type="button"
                                        class="remove-previous-policy absolute top-2 right-2 text-gray-500 hover:text-gray-800 bg-transparent p-1 rounded"
                                        aria-label="Remove previous policy">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                </div>
                            </template>

                            <!-- Templates for dynamic sibling/child entries -->
                            <template id="sibling-template">
                                <div
                                    class="sibling-item relative grid grid-cols-1 md:grid-cols-6 gap-3 p-3 rounded border border-gray-200 bg-white items-end">
                                    <button type="button"
                                        class="remove-sibling absolute top-2 right-2 text-gray-500 hover:text-gray-800 bg-transparent p-1 rounded"
                                        aria-label="Remove sibling">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                    <div class="md:col-span-6">
                                        <div class="text-sm font-medium sibling-header text-gray-700 mb-2">Sibling
                                        </div>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Age</label><input type="number" min="0"
                                            class="mt-1 sibling-age"></div>
                                    <div><label class="text-xs text-gray-600">State</label>
                                        <select class="mt-1 sibling-state dropdown-padding" style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Good">Good</option>
                                            <option value="Dead">Dead</option>
                                        </select>
                                    </div>
                                    <div class="sibling-death-container md:col-span-3 hidden">
                                        <div class="grid grid-cols-3 gap-2 md:gap-4 w-full">
                                            <div><label class="text-xs text-gray-600">Age at Death</label><input
                                                    type="text" class="mt-1 sibling-died-age"></div>
                                            <div><label class="text-xs text-gray-600">Death Year</label><input
                                                    type="text" class="mt-1 sibling-died-year"></div>
                                            <div><label class="text-xs text-gray-600">Cause of Death</label><input
                                                    type="text" class="mt-1 sibling-died-cause"></div>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <template id="child-template">
                                <div
                                    class="child-item relative grid grid-cols-1 md:grid-cols-6 gap-3 p-3 rounded border border-gray-200 bg-white items-end">
                                    <button type="button"
                                        class="remove-child absolute top-2 right-2 text-gray-500 hover:text-gray-800 bg-transparent p-1 rounded"
                                        aria-label="Remove child">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                    <div class="md:col-span-6">
                                        <div class="text-sm font-medium child-header text-gray-700 mb-2">Child</div>
                                    </div>
                                    <div><label class="text-xs text-gray-600">Age</label><input type="number" min="0"
                                            class="mt-1 child-age"></div>
                                    <div><label class="text-xs text-gray-600">State</label>
                                        <select class="mt-1 child-state dropdown-padding" style="height:3rem;">
                                            <option value="">Select</option>
                                            <option value="Good">Good</option>
                                            <option value="Dead">Dead</option>
                                        </select>
                                    </div>
                                    <div class="child-death-container md:col-span-3 hidden">
                                        <div class="grid grid-cols-3 gap-2 md:gap-4 w-full">
                                            <div><label class="text-xs text-gray-600">Age at Death</label><input
                                                    type="text" class="mt-1 child-died-age"></div>
                                            <div><label class="text-xs text-gray-600">Death Year</label><input
                                                    type="text" class="mt-1 child-died-year"></div>
                                            <div><label class="text-xs text-gray-600">Cause of Death</label><input
                                                    type="text" class="mt-1 child-died-cause"></div>
                                        </div>
                                    </div>

                                </div>
                            </template>
                            <div class="mt-3">
                                <button type="button" id="add-previous-policy"
                                    class="bg-blue-600 text-white font-bold py-2 px-4 rounded">Add Previous
                                    Policy</button>
                            </div>
                        </div>
                        <div class="flex justify-between mt-6"><button type="button" onclick="navigateFormTab(-1)"
                                class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700">&larr;
                                Previous</button>
                            <div class="flex space-x-4">
                                <button type="button" id="save-draft-btn"
                                    class="bg-yellow-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-yellow-700 transition duration-300 shadow-lg">Save
                                    Draft</button>
                                <button type="submit"
                                    class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition duration-300 shadow-lg">Submit
                                    Data</button>
                            </div>
                        </div>

                    </div>
                </form>
            </div>
        </div>

        <div id="data-view" class="hidden">
            <div class="max-w-4xl mx-auto">
                <!-- Header container with relative positioning -->
                <div class="relative flex justify-center items-center mb-8">
                    <div class="absolute left-0"><img src="assets/lic_logo.png" alt="Company Logo"
                            class="h-16 w-auto object-contain"></div>
                    <h1 class="text-3xl font-bold"
                        style="background: linear-gradient(135deg, var(--primary-start), var(--primary-end), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        Data Sheet</h1>
                    <div class="absolute right-0 text-right">
                        <h2 class="text-xl font-bold text-gray-800">Rapolu Venkateshwarlu</h2>
                        <p class="text-sm text-gray-600">Insurance Advisor</p>
                    </div>
                </div>

                <!-- Main Tab Navigation -->
                <div class="flex justify-center space-x-4 mb-8">
                    <button id="form-tab-button" class="main-tab-button" onclick="showMainTab('form-view')">Data
                        Entry
                        Form</button>
                    <button id="view-tab-button" class="main-tab-button active" onclick="showMainTab('data-view')">View
                        Submitted Data</button>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-center sm:justify-end mb-6 space-x-4">
                        <div class="flex flex-wrap gap-4 mb-6">
                            <button id="export-json"
                                class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition duration-300">
                                üìÅ Export
                            </button>
                            <label for="import-json"
                                class="bg-purple-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-purple-700 transition duration-300 cursor-pointer">
                                üìÇ Import
                            </label>
                            <input type="file" id="import-json" accept=".json" style="display: none;">
                            <button id="clear-data"
                                class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition duration-300">Clear
                                Data</button>
                        </div>
                    </div>
                    <!-- 
                    <div class="mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded">
                        <strong>Security Note:</strong> Data is stored locally in your browser. For production use,
                        implement server-side storage and encryption.
                    </div> -->

                    <div class="mb-4">
                        <input type="text" id="search-input" placeholder="Search by name or policy number..."
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Subtabs for Drafts/Submitted -->
                    <div class="flex space-x-4 mb-4 border-b border-gray-200">
                        <button id="subtab-submitted" class="py-2 px-4 text-sm font-medium text-blue-600 border-b-2 border-blue-600 focus:outline-none" onclick="UIModule.switchViewSubtab('submitted')">Submitted Data</button>
                        <button id="subtab-drafts" class="py-2 px-4 text-sm font-medium text-gray-500 hover:text-gray-700 focus:outline-none" onclick="UIModule.switchViewSubtab('drafts')">Drafts</button>
                    </div>

                    <div id="data-table-container" class="overflow-x-auto">
                        <!-- Table will be generated here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Gemini AI Modal -->
        <div id="gemini-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="modal-title" class="text-xl font-bold">AI Generated Content</h3>
                    <button onclick="closeModal()"
                        class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
                </div>
                <div id="modal-body">
                    <div class="flex items-center justify-center h-32">
                        <div class="loader"></div>
                    </div>
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button id="copy-button"
                        class="bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-300">Copy
                        Text</button>
                    <button onclick="closeModal()"
                        class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">Close</button>
                </div>
            </div>
        </div>

        <!-- Row Details Modal -->
        <div id="row-details-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="row-modal-title" class="text-xl font-bold">Policy Details</h3>
                    <button onclick="closeRowDetails()"
                        class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
                </div>
                <!-- Modal tabs -->
                <div class="mb-4 border-b border-gray-200">
                    <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                        <button id="modal-tab-overview"
                            class="py-2 px-4 text-sm font-medium text-gray-700 border-b-2 border-transparent"
                            type="button">Overview</button>
                        <button id="modal-tab-prevpol"
                            class="py-2 px-4 text-sm font-medium text-gray-700 border-b-2 border-transparent"
                            type="button">Previous Policies</button>
                        <button id="modal-tab-nominee"
                            class="py-2 px-4 text-sm font-medium text-gray-700 border-b-2 border-transparent"
                            type="button">Nominees</button>
                    </nav>
                </div>

                <div id="row-modal-body" class="text-sm text-gray-700 max-h-[65vh] overflow-y-auto">
                    <!-- Overview content -->
                    <div id="row-modal-overview" class="grid gap-4 grid-cols-1 sm:grid-cols-2"></div>

                    <!-- Previous policies content (hidden by default) -->
                    <div id="row-modal-prevpol" class="hidden">
                        <div class="flex items-start space-x-4">
                            <div id="prevpol-list" class="w-1/3 border-r pr-4 space-y-2 max-h-[55vh] overflow-y-auto">
                                <!-- policy list injected here -->
                            </div>
                            <div id="prevpol-detail" class="w-2/3 pl-4">
                                <!-- selected policy details -->
                            </div>
                        </div>
                    </div>

                    <!-- Nominees content (hidden by default) - converted to a selectable list + detail pane -->
                    <div id="row-modal-nominee" class="hidden">
                        <!-- Appointee container placed above the two-column nominee list/detail so it appears first -->
                        <div id="appointee-container" class="mb-3"></div>
                        <div class="flex items-start space-x-4">
                            <div id="nominee-list" class="w-1/3 border-r pr-4 space-y-2 max-h-[50vh] overflow-y-auto">
                                <!-- nominee list injected here -->
                            </div>
                            <div id="nominee-detail" class="w-2/3 pl-4">
                                <!-- selected nominee details injected here (nominee cards will be rendered below the Appointee container) -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button id="row-modal-edit"
                        class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">Edit</button>
                    <button type="button" onclick="closeRowDetails()"
                        class="modal-close-button font-bold py-2 px-4 rounded-lg">Close</button>
                </div>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmation-modal" class="modal-overlay hidden">
            <div class="modal-content max-w-xl">
                <div class="mb-4">
                    <h3 id="confirm-modal-title" class="text-xl font-bold text-gray-800">Confirm Action</h3>
                </div>
                <div id="confirm-modal-body" class="mb-6 text-gray-600">
                    Are you sure you want to proceed?
                </div>
                <div class="flex justify-end space-x-3">
                    <button id="confirm-cancel-btn"
                        class="modal-close-button font-bold py-2 px-4 rounded-lg">Cancel</button>
                    <button id="confirm-ok-btn"
                        class="px-4 py-2 bg-red-600 text-white rounded font-semibold hover:bg-red-700 transition duration-200 shadow-lg">Confirm</button>
                </div>
            </div>
        </div>

        <!-- All application logic is now in modular JavaScript files loaded by loader.js -->
        <!-- init.js handles application initialization after modules load -->
        <script>
            // Theme Toggle Functionality
            (function () {
                const themeToggle = document.getElementById('theme-toggle');
                const body = document.body;

                // Check for saved preference or system preference
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

                // Apply initial theme
                if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                    body.classList.add('dark');
                }

                // Toggle theme on button click
                themeToggle.addEventListener('click', () => {
                    body.classList.toggle('dark');
                    const isDark = body.classList.contains('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');

                    // Add a subtle animation feedback
                    themeToggle.style.transform = 'scale(1.2) rotate(180deg)';
                    setTimeout(() => {
                        themeToggle.style.transform = '';
                    }, 300);
                });

                // Listen for system preference changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (!localStorage.getItem('theme')) {
                        body.classList.toggle('dark', e.matches);
                    }
                });
            })();
        </script>
</body>

</html>